!function(e){function t(t){for(var n,c,o=t[0],i=t[1],u=t[2],p=0,f=[];p<o.length;p++)c=o[p],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&f.push(a[c][0]),a[c]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);for(l&&l(t);f.length;)f.shift()();return s.push.apply(s,u||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,o=1;o<r.length;o++){var i=r[o];0!==a[i]&&(n=!1)}n&&(s.splice(t--,1),e=c(c.s=r[0]))}return e}var n={},a={21:0},s=[];function c(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.m=e,c.c=n,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(r,n,function(t){return e[t]}.bind(null,n));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var o=window.webpackWPML=window.webpackWPML||[],i=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=i;s.push([1282,0]),r()}({106:function(e,t,r){},1282:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),s=r(34),c=r.n(s),o=r(31),i=r.n(o),u=r(1),l=r(393),p=r(203),f=(r(69),r(72),r(9)),d=r.n(f),b=r(16),m=r(202),g=r(1311),h=function(e){var t=Object(n.useState)(!1),r=d()(t,2),a=r[0],s=r[1],c=Object(n.useState)(!1),o=d()(c,2),i=o[0],l=o[1],p=function(e){return l({type:"error",msg:e})};Object(n.useEffect)((function(){i&&setTimeout((function(){return l(!1)}),2e3)}),[i]);return{result:i,inProgress:a,refresh:function(t){t.preventDefault(),s(!0),Object(b.c)({action:"update_site_key",repository_id:"wpml",nonce:e}).then(m.a("",["data","data","error"])).then((function(e){if(!g.a(e))throw e;var t;t=Object(u.a)("WPML License has been refreshed","sitepress"),l({type:"success",msg:t})})).catch(p).finally((function(){s(!1)}))}}},v=function(e){var t=e.nonce,r=h(t),n=r.inProgress,s=r.result,c=r.refresh;return a.a.createElement(a.a.Fragment,null,a.a.createElement("a",{className:"button-secondary",href:"#",onClick:c},Object(u.a)("Refresh license data to recognise license update","sitepress")),n&&a.a.createElement(l.a,null),s&&a.a.createElement(p.a,{message:s.msg,type:s.type}))},y=r(3),O=r.n(y),j=r(7),E=r.n(j),w=r(863),P=(r(702),r(13)),k=r.n(P);function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var S="CHECKING_TOTAL",D="IN_PROGRESS",_="FINISHED",R="ERROR",C="START",I="SET_TOTAL",A="ADD_CANCELLED",z="SHOW_ERROR",M="FINISH",L="RESET",N={stage:void 0,total:void 0,cancelled:void 0,message:void 0},F=function(e,t){switch(t.type){case C:return T(T({},e),{},{stage:S});case I:return T(T({},e),{},{stage:D,total:t.payload,cancelled:0});case A:return T(T({},e),{},{cancelled:e.cancelled+t.payload});case M:return T(T({},e),{},{stage:_,message:t.payload});case z:return T(T({},e),{},{stage:R,message:t.payload});case L:return N;default:return e}},B=function(e){switch(e.stage){case D:return parseInt(e.cancelled/e.total*100);case _:return 100;default:return 0}},W=function(){var e=Object(n.useReducer)(F,N),t=d()(e,2),r=t[0],a=t[1];return{state:r,reset:function(){return a({type:L})},start:function(){return a({type:C})},setTotal:function(e){return a({type:I,payload:e})},addCancelled:function(e){return a({type:A,payload:e})},finish:function(e){return a({type:M,payload:e})},showError:function(e){return a({type:z,payload:e})},canRunTheProcess:function(e){return!e.stage},isInProgress:function(e){return e.stage===S||e.stage===D},calculatePercentage:B}};var J=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,r=function(){var t=E()(O.a.mark((function t(){var r,n,a,s;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(b.a)(e,{getTotal:!0});case 2:if(r=t.sent,n=r.data,a=n.success,s=n.data,!a){t.next=8;break}return t.abrupt("return",parseInt(s));case 8:throw new Error(s);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=function(){var r=E()(O.a.mark((function r(){var n,a,s,c;return O.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(b.a)(e,{batchSize:t});case 2:return n=r.sent,a=n.data,s=a.success,c=a.data,r.abrupt("return",s?parseInt(c):0);case 7:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return{batchSize:t,checkTotalNumber:r,cancelBatch:n}},H=function(e){return function(){switch(e.stage){case S:return Object(u.a)("Preparing...","sitepress");case D:return"".concat(e.cancelled," / ").concat(e.total);case _:case R:return e.message;default:return""}}},q=function(e){switch(e.stage){case _:return"success";case R:return"exception";default:return"normal"}},U=function(e){var t=e.endpoint,r=W(),s=r.state,c=r.reset,o=r.start,i=r.setTotal,p=r.addCancelled,f=r.finish,d=r.showError,b=r.canRunTheProcess,m=r.calculatePercentage,g=r.isInProgress;Object(n.useEffect)((function(){s.stage!==_&&s.stage!==R||setTimeout(c,1e4)}),[s]);var h=J(t),v=function(){var e=E()(O.a.mark((function e(t){var r,n,a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),b(s)){e.next=3;break}return e.abrupt("return");case 3:return o(),e.prev=4,e.next=7,h.checkTotalNumber();case 7:if(r=e.sent,i(r),!(r>0)){e.next=23;break}n=Math.ceil(r/h.batchSize),a=0;case 12:if(!(a<n)){e.next=20;break}return e.next=15,h.cancelBatch();case 15:c=e.sent,p(c);case 17:a++,e.next=12;break;case 20:f(Object(u.a)("All jobs have been cancelled","sitepress")),e.next=24;break;case 23:f(Object(u.a)("There is no more jobs to cancel","sitepress"));case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(4),d(Object(u.a)("The jobs cancellation has failed","sitepress"));case 29:case"end":return e.stop()}}),e,null,[[4,26]])})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement(a.a.Fragment,null,a.a.createElement("a",{className:"button-secondary",href:"#",onClick:v},Object(u.a)("Cancel in-progress automatic jobs","sitepress")),g(s)&&a.a.createElement(l.a,null),s.stage&&a.a.createElement(w.a,{percent:m(s),status:q(s),format:H(s)}))};var G=function(e){return{updateDomain:function(){var t=E()(O.a.mark((function t(){var r,n,a,s,c,o=arguments;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.length>0&&void 0!==o[0]?o[0]:{},t.next=3,Object(b.a)(e,r);case 3:if(n=t.sent,a=n.data,s=a.success,c=a.data,!s){t.next=9;break}return t.abrupt("return",c);case 9:throw new Error(c);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}},Q=function(e){var t=e.endpoint,r=Object(n.useState)(!1),s=d()(r,2),c=s[0],o=s[1],i=Object(n.useState)(null),f=d()(i,2),b=f[0],m=f[1],g=function(e){return m({type:"error",msg:e})};Object(n.useEffect)((function(){b&&setTimeout((function(){return m(null)}),4e3)}),[b]);var h=G(t),v=function(){var e=E()(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,o(!0),e.next=5,h.updateDomain();case 5:e.sent,r=Object(u.a)("Domain name has been updated","sitepress"),m({type:"success",msg:r}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),g(Object(u.a)("Domain name update has been failed","sitepress"));case 12:return e.prev=12,o(!1),e.finish(12);case 15:case"end":return e.stop()}var r}),e,null,[[1,9,12,15]])})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement(a.a.Fragment,null,a.a.createElement("a",{className:"button-secondary",href:"#",onClick:v},Object(u.a)("Update domain name in language switcher settings","sitepress")),c&&a.a.createElement(l.a,null),b&&a.a.createElement(p.a,{message:b.msg,type:b.type}))},Y=r(502),K=r.n(Y),V=(r(410),r(134)),X=r.n(V),Z=r(117),$=r.n(Z),ee=r(492),te=r.n(ee);r(106);function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ae=function(){var e=Object(n.useState)({isProcessing:!1,isCompleted:!1,error:null,previousStateProgress:{total:0,processed:0},translationElementsProgress:{total:0,processed:0}}),t=d()(e,2),r=t[0],a=t[1],s=function(e){return function(t){a((function(r){return ne(ne({},r),{},k()({},e,ne(ne({},r[e]),{},{processed:r[e].total-t})))}))}},c=function(e){return function(t){a((function(r){return ne(ne({},r),{},k()({},e,ne(ne({},r[e]),{},{total:t})))}))}},o=function(){var e=E()(O.a.mark((function e(t,r,n){var s,c,o,i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(b.a)(troubleshooting.endpoints.optimizeTranslationTables,{migrationType:t,isInitialRequest:!0});case 3:if((s=e.sent).data.success){e.next=6;break}throw new Error(s.data.data);case 6:c=s.data.data,n(c),o=c;case 9:if(!(o>0)){e.next=19;break}return e.next=12,Object(b.a)(troubleshooting.endpoints.optimizeTranslationTables,{migrationType:t,isInitialRequest:!1});case 12:if((i=e.sent).data.success){e.next=15;break}throw new Error(i.data.data);case 15:o=i.data.data,r(o),e.next=9;break;case 19:e.next=25;break;case 21:throw e.prev=21,e.t0=e.catch(0),a((function(t){return ne(ne({},t),{},{error:e.t0.message})})),e.t0;case 25:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(t,r,n){return e.apply(this,arguments)}}(),i=function(){var e=E()(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.a)(troubleshooting.endpoints.optimizeTranslationTables,{migrationType:"truncate-translation-package"});case 2:if((t=e.sent).data.success){e.next=5;break}throw new Error(t.data.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{state:r,optimize:function(){var e=E()(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a((function(e){return ne(ne({},e),{},{isProcessing:!0,error:null,isCompleted:!1,previousStateProgress:{total:0,processed:0},translationElementsProgress:{total:0,processed:0}})})),e.prev=1,e.next=4,Promise.all([o("previous-state",s("previousStateProgress"),c("previousStateProgress")),o("translation-elements",s("translationElementsProgress"),c("translationElementsProgress"))]);case 4:return e.next=6,i();case 6:a((function(e){return ne(ne({},e),{},{isCompleted:!0})})),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:return e.prev=11,a((function(e){return ne(ne({},e),{},{isProcessing:!1})})),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,9,11,14]])})));return function(){return e.apply(this,arguments)}}()}},se=function(){return a.a.createElement($.a,{message:Object(u.a)("Warning","sitepress"),description:Object(u.a)("This process is resource-intensive and may take a significant amount of time. It is recommended to run this optimization during periods of low traffic.","sitepress"),type:"warning",showIcon:!0,style:{marginBottom:"20px"}})},ce=function(){return a.a.createElement($.a,{message:Object(u.a)("Disclaimer: MySQL Disk Space","sitepress"),description:Object(u.a)("Cleaning and compressing the wp_icl_translate and wp_icl_translation_status tables reduces its data size, but does not automatically free up disk space in MySQL. To reclaim disk space, a table rebuild is required—a risky operation not performed automatically by this tool.","sitepress"),type:"warning",showIcon:!0,style:{marginBottom:"20px"}})},oe=function(){var e=ae(),t=e.state,r=e.optimize,n=t.isProcessing,s=t.isCompleted,c=t.error,o=t.previousStateProgress,i=t.translationElementsProgress,l=function(e){return 0===e.total?0:Math.round(e.processed/e.total*100)};return a.a.createElement(K.a,null,!s&&a.a.createElement(a.a.Fragment,null,a.a.createElement(se,null),a.a.createElement(ce,null),a.a.createElement(X.a,{type:"primary",onClick:r,disabled:n,loading:n,style:{marginBottom:"20px"}},Object(u.a)("Optimize translation tables","sitepress"))),n&&a.a.createElement("div",{style:{marginTop:"20px"}},a.a.createElement("div",{style:{marginBottom:"15px"}},a.a.createElement("div",null,Object(u.a)("Previous State Migration","sitepress")),a.a.createElement(te.a,{percent:l(o),status:"active"}),a.a.createElement("div",{style:{fontSize:"12px",color:"#666"}},Object(u.a)("Processed","sitepress")," ",o.processed,"/",o.total)),a.a.createElement("div",null,a.a.createElement("div",null,Object(u.a)("Translation Elements Migration","sitepress")),a.a.createElement(te.a,{percent:l(i),status:"active"}),a.a.createElement("div",{style:{fontSize:"12px",color:"#666"}},Object(u.a)("Processed","sitepress")," ",i.processed,"/",i.total))),c&&a.a.createElement($.a,{message:Object(u.a)("Error","sitepress"),description:c,type:"error",showIcon:!0,style:{marginTop:"20px"}}),s&&!c&&a.a.createElement($.a,{message:Object(u.a)("Success","sitepress"),description:Object(u.a)("Database tables optimization completed successfully.","sitepress"),type:"success",showIcon:!0,style:{marginTop:"20px"}}))},ie=function(){return troubleshooting.doTranslationTablesRequireOptimization?a.a.createElement(K.a,{title:Object(u.a)("Database Tables Optimization","sitepress"),style:{maxWidth:"600px"}},a.a.createElement(oe,null)):null},ue=r(93),le=r.n(ue),pe=function(e){return{repairJobs:function(){var t=E()(O.a.mark((function t(){var r,n,a,s;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(b.a)(e,{});case 3:if(null==(s=t.sent)||null===(r=s.data)||void 0===r||null===(n=r.data)||void 0===n||!n.success){t.next=6;break}return t.abrupt("return",s.data.data);case 6:console.error((null==s||null===(a=s.data)||void 0===a?void 0:a.data)||(null==s?void 0:s.data)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:return t.abrupt("return",{});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}()}},fe=r(1316),de="START",be="UPDATE_STATUS",me="FINISHED",ge="ERROR",he=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;switch(e){case de:return Object(u.a)("Checking for stuck translation jobs...","sitepress");case be:return Object(u.c)(Object(u.b)("Processing... %s stuck translation found so far","Processing... %s stuck translations found so far",t,"sitepress"),t);case me:return ve(t);case ge:return Object(fe.a)(Object(u.a)("Something went wrong while checking for stuck translation jobs. Please <a>contact WPML support</a>.","sitepress"),{a:a.a.createElement("a",{href:"https://wpml.org/forums/forum/english-support/?utm_source=plugin&utm_medium=gui&utm_campaign=core&utm_term=troubleshooting-stuck-translations",target:"_blank",rel:"noopener noreferrer"})});default:return""}},ve=function(e){return 0===e?Object(u.a)("No stuck translation jobs found.","sitepress"):Object(u.c)(Object(u.b)("%s stuck translation job found. WPML will translate it automatically in the background.\nYou can check the progress in the Translation Dashboard.","%s stuck translation jobs found. WPML will translate them automatically in the background.\nYou can check their progress in the Translation Dashboard.",e,"sitepress"),e)},ye=r(855);function Oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(r),!0).forEach((function(t){k()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ee={inProgress:!1,complete:!1,message:"",jobsProcessed:0},we=function(e,t){var r=null!=t&&t.jobCount?e.jobsProcessed+Object(ye.toNumber)(t.jobCount):e.jobsProcessed;switch(t.type){case de:return je(je({},e),{},{inProgress:!0,jobsProcessed:0,message:he(t.type)});case be:return je(je({},e),{},{jobsProcessed:r,message:he(t.type,r)});case me:return je(je({},e),{},{inProgress:!1,complete:!0,message:he(t.type,r)});case ge:return je(je({},e),{},{inProgress:!1,complete:!0,message:he(t.type)});default:return e}},Pe=function(e){var t=e.endpoint,r=e.isTEAEnabled,s=r?"":"disabled",c=r?{}:{title:Object(u.a)("Translate Everything Automatically is not active.","sitepress")},o=function(){var e=Object(n.useReducer)(we,Ee),t=d()(e,2),r=t[0],a=t[1];return{state:r,dispatchAction:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return a({type:e,jobCount:t})}}}(),l=o.state,f=o.dispatchAction,b=function(){var e=E()(O.a.mark((function e(t){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.repairJobs();case 2:if(null==(r=e.sent)||!r.success){e.next=9;break}if(f(be,r.count),!r.hasMore){e.next=9;break}return e.next=8,b(t);case 8:return e.abrupt("return",e.sent);case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=E()(O.a.mark((function e(n){var a,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),r){e.next=3;break}return e.abrupt("return");case 3:return a=pe(t),f(de),e.next=7,b(a);case 7:null!=(s=e.sent)&&s.success?f(me):f(ge);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement(a.a.Fragment,null,a.a.createElement("a",i()({onClick:m},c,{className:"button-secondary ".concat(s),href:"#"}),Object(u.a)("Retry stuck automatic translations","sitepress")),l.inProgress&&a.a.createElement(le.a,{style:{margin:"4px 0 0 10px"}}),(l.complete||l.inProgress)&&a.a.createElement(p.a,{closable:!0,type:"info",message:l.message}),a.a.createElement("p",{style:{marginLeft:"10px"}},Object(u.a)("Resends translation jobs that couldn't be processed due to a temporary issue while Translate Everything Automatically was active.","sitepress")))},ke=function(e){var t=e.children,r=e.id,n=void 0===r?void 0:r;return a.a.createElement("div",i()({style:{marginTop:"5px",marginBottom:"5px"}},n&&{id:n}),t)},xe=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(ke,null,a.a.createElement(v,{nonce:troubleshooting.refreshLicense.nonce})),a.a.createElement(ke,null,a.a.createElement(U,{key:"cancel-jobs",endpoint:troubleshooting.endpoints.cancelJobs})),a.a.createElement(ke,null,a.a.createElement(Pe,{endpoint:troubleshooting.endpoints.retryStuckAutomaticJobs,isTEAEnabled:troubleshooting.isTEAEnabled})),a.a.createElement(ke,null,a.a.createElement(Q,{endpoint:troubleshooting.endpoints.lsTemplatesUpdateDomain})),a.a.createElement(ke,null,a.a.createElement(ie,null)))};document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("wpml-troubleshooting-container");e&&c.a.render(a.a.createElement(xe,null),e)}))},410:function(e,t,r){},69:function(e,t,r){},702:function(e,t,r){},72:function(e,t,r){}});