{"version":3,"file":"../../js/llms-admin-media-protection-block-protect.min.js","sources":["llms-admin-media-protection-block-protect.js"],"sourcesContent":["(()=>{\"use strict\";const e=window.wp.element;!function(t){const{addFilter:r}=t.hooks,{createHigherOrderComponent:l}=t.compose,{Fragment:o,useState:a,useEffect:n,useRef:c}=t.element,{ToolbarButton:s,Modal:i,Button:m,Flex:u,FlexItem:d,Notice:p}=t.components,{BlockControls:h}=t.blockEditor,{apiFetch:g}=t,{sprintf:E}=t.i18n,b=[\"core/image\",\"core/video\",\"core/audio\",\"core/file\"],w=e=>{switch(e){case\"core/image\":default:return\"url\";case\"core/audio\":case\"core/video\":return\"src\";case\"core/file\":return\"href\"}};r(\"editor.BlockEdit\",\"my-plugin/with-protect-image-toolbar\",l((t=>r=>{const l=E(LLMS.l10n.translate(\"This media is not protected. If you select a product here, the media will be moved to the protected uploads directory and existing links to the media will no longer work. %1$sLearn More%2$s\"),'<a href=\"https://lifterlms.com/docs/how-protected-media-files-work/\" target=\"_blank\">',\"</a>\");if(!r.attributes||!r.attributes.id)return(0,e.createElement)(t,r);if(!b.includes(r.name))return(0,e.createElement)(t,r);const[f,_]=a(!1),[k,S]=a(null),y=c(null);return n((()=>{f&&y.current&&jQuery(y.current).llmsPostsSelect2()}),[f]),(0,e.createElement)(o,null,(0,e.createElement)(t,r),(0,e.createElement)(h,{group:\"inline\"},(0,e.createElement)(s,{icon:\"lock\",label:\"Protect Image\",onClick:()=>_(!0)})),f&&(0,e.createElement)(i,{title:LLMS.l10n.translate(\"Select Course or Membership\"),onRequestClose:()=>_(!1)},(0,e.createElement)(u,{direction:\"column\",gap:4},(0,e.createElement)(d,null,(0,e.createElement)(\"label\",{htmlFor:\"llms-protect-image-select\"},LLMS.l10n.translate(\"Select a Course or Membership to protect this image:\"))),(0,e.createElement)(d,null,!r.attributes[w(r.name)].includes(\"llms_media_id\")&&(0,e.createElement)(p,{status:\"warning\",isDismissible:!1},(0,e.createElement)(\"span\",{dangerouslySetInnerHTML:{__html:l}})),(0,e.createElement)(\"select\",{id:\"llms-protect-image-select\",ref:y,className:\"llms-block-protect llms-posts-select2\",\"data-no-view-button\":\"true\",\"data-allow_clear\":\"false\",\"data-post-type\":\"course,llms_membership\"})),(0,e.createElement)(d,null,(0,e.createElement)(m,{isPrimary:!0,onClick:()=>{(()=>{const e=jQuery(y.current).val();g({path:`/wp/v2/media/${r.attributes.id}`,method:\"POST\",data:{_llms_media_protection_product_id:e}}).then((e=>{const t=w(r.name);r.setAttributes({[t]:e.source_url})})).catch((e=>{console.error(\"Error updating media meta:\",e)})),_(!1)})()}},\"Protect Image\")))))}),\"withProtectImageToolbar\"))}(window.wp)})();"],"names":["e","window","wp","element","t","r","hooks","addFilter","l","compose","createHigherOrderComponent","Fragment","o","useState","a","useEffect","n","useRef","c","ToolbarButton","s","Modal","i","Button","m","Flex","u","FlexItem","d","Notice","p","components","h","blockEditor","BlockControls","g","apiFetch","E","i18n","sprintf","b","w","LLMS","l10n","translate","attributes","id","createElement","includes","name","f","_","y","current","jQuery","llmsPostsSelect2","group","icon","label","onClick","title","onRequestClose","direction","gap","htmlFor","status","isDismissible","dangerouslySetInnerHTML","__html","ref","className","data-no-view-button","data-allow_clear","data-post-type","isPrimary","val","path","method","data","_llms_media_protection_product_id","then","setAttributes","source_url","catch","console","error"],"mappings":"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","sourceRoot":"../../js"}